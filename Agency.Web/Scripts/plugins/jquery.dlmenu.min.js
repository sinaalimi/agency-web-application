(function(n,t){"use strict";var i=t.Modernizr,u=n("body"),r;n.DLMenu=function(t,i){this.$el=n(i);this._init(t)};n.DLMenu.defaults={animationClasses:{classin:"dl-animate-in-1",classout:"dl-animate-out-1"},onLevelClick:function(){return!1},onLinkClick:function(){return!1}};n.DLMenu.prototype={_init:function(t){this.options=n.extend(!0,{},n.DLMenu.defaults,t);this._config();this.animEndEventName={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",animation:"animationend"}[i.prefixed("animation")]+".dlmenu";this.transEndEventName={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"}[i.prefixed("transition")]+".dlmenu";this.supportAnimations=i.cssanimations;this.supportTransitions=i.csstransitions;this._initEvents()},_config:function(){this.open=!1;this.$trigger=this.$el.children(".dl-trigger");this.$menu=this.$el.children("ul.dl-menu");this.$menuitems=this.$menu.find("li:not(.dl-back)");this.$el.find("ul.dl-submenu").prepend('<li class="dl-back"><a href="#"><span class="fa fa-arrow-up"><\/span>برگشت<\/a><\/li>');this.$back=this.$menu.find("li.dl-back")},_initEvents:function(){var t=this;this.$trigger.on("click.dlmenu",function(){return t.open?t._closeMenu():t._openMenu(),!1});this.$menuitems.on("click.dlmenu",function(i){var r,u,f,e;if(i.stopPropagation(),r=n(this),u=r.children("ul.dl-submenu"),u.length>0)return f=u.clone().css("opacity",0).insertAfter(t.$menu),e=function(){t.$menu.off(t.animEndEventName).removeClass(t.options.animationClasses.classout).addClass("dl-subview");r.addClass("dl-subviewopen").parents(".dl-subviewopen:first").removeClass("dl-subviewopen").addClass("dl-subview");f.remove()},setTimeout(function(){if(f.addClass(t.options.animationClasses.classin),t.$menu.addClass(t.options.animationClasses.classout),t.supportAnimations)t.$menu.on(t.animEndEventName,e);else e.call();t.options.onLevelClick(r,r.children("a:first").text())}),!1;t.options.onLinkClick(r,i)});this.$back.on("click.dlmenu",function(){var i=n(this),r=i.parents("ul.dl-submenu:first"),e=r.parent(),u=r.clone().insertAfter(t.$menu),f=function(){t.$menu.off(t.animEndEventName).removeClass(t.options.animationClasses.classin);u.remove()};return setTimeout(function(){if(u.addClass(t.options.animationClasses.classout),t.$menu.addClass(t.options.animationClasses.classin),t.supportAnimations)t.$menu.on(t.animEndEventName,f);else f.call();e.removeClass("dl-subviewopen");var n=i.parents(".dl-subview:first");n.is("li")&&n.addClass("dl-subviewopen");n.removeClass("dl-subview")}),!1})},closeMenu:function(){this.open&&this._closeMenu()},_closeMenu:function(){var n=this,t=function(){n.$menu.off(n.transEndEventName);n._resetMenu()};if(this.$menu.removeClass("dl-menuopen"),this.$menu.addClass("dl-menu-toggle"),this.$trigger.removeClass("dl-active"),this.supportTransitions)this.$menu.on(this.transEndEventName,t);else t.call();this.open=!1},openMenu:function(){this.open||this._openMenu()},_openMenu:function(){var t=this;u.off("click").on("click.dlmenu",function(){t._closeMenu()});this.$menu.addClass("dl-menuopen dl-menu-toggle").on(this.transEndEventName,function(){n(this).removeClass("dl-menu-toggle")});this.$trigger.addClass("dl-active");this.open=!0},_resetMenu:function(){this.$menu.removeClass("dl-subview");this.$menuitems.removeClass("dl-subview dl-subviewopen")}};r=function(n){t.console&&t.console.error(n)};n.fn.dlmenu=function(t){if(typeof t=="string"){var i=Array.prototype.slice.call(arguments,1);this.each(function(){var u=n.data(this,"dlmenu");if(!u){r("cannot call methods on dlmenu prior to initialization; attempted to call method '"+t+"'");return}if(!n.isFunction(u[t])||t.charAt(0)==="_"){r("no such method '"+t+"' for dlmenu instance");return}u[t].apply(u,i)})}else this.each(function(){var i=n.data(this,"dlmenu");i?i._init():i=n.data(this,"dlmenu",new n.DLMenu(t,this))});return this}})(jQuery,window);